<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
	<!-- 上述3个meta标签*必须*放在最前面，任何其他内容都*必须*跟随其后！ -->
	<title>客户主体信息管理</title>

	<link rel="shortcut icon" href="../ico/qm.png">
	<link rel="stylesheet" type="text/css" href="../css/page.css">
	<link rel="stylesheet" type="text/css" href="../css/bootstrap.min.css">
	<link rel="stylesheet" type="text/css" href="../css/bootstrapStyle.css">
	<link rel="stylesheet" type="text/css" href="../css/comm.css">
	<link rel="stylesheet" type="text/css" href="../css/bootstrap-select.min.css">
	
	<script type="text/javascript" src="../js/jquery.min.js"></script>
    <script type="text/javascript" src="../js/bootstrap.min.js"></script>
    <script type="text/javascript" src="../js/bootstrap-select.min.js"></script>
    <script type="text/javascript" src="../js/comm.js"></script>
	<script type="text/javascript" src="../js/vue.js"></script>
	<script type="text/javascript" src="../js/vue-resource.js"></script>
	
	<style type="text/css">
		
	</style>
	<script>
	

       $(document).ready(function(){
        
       
	      var searchUrl = window.location.href;
// 		  alert(searchUrl);
		  var searchData = searchUrl.split("="); //截取 url中的“=”,获得“=”后面的参数
// 		  alert(searchData);
		  var custID = decodeURI(searchData[1]); //decodeURI解码
// 		  alert(custID);
		
           $(".tishi").delay(15000).fadeOut(1800); //显示一会提示信息后淡出
        
	    
            var v = new Vue({
                el:'#boxContainer',
                data:{
                },
                methods:{
                
	                changeTab:function(v){
	                	//alert(v); 
// 	                	v_app.currentPage=1;
// 	                	v_link.currentPage=1;
// 	                	v_invent.currentPage=1;
						if(v==1){
							v_app.loadData();
						}
						if(v==2){
							v_invent.loadData();
						}
						if(v==3){
							v_link.loadData();
						}
	                }
                }
            });
            var v_app = new Vue({
                el:'#box_app',
                data:{
                	simpleCust:[], // 客户集合
                    myData:[], // 列表数据
                    totalNum:'',//总条数 
                    totalPage:'',//总页数 
                    currentPage:1,//当前页 
                    changePage:'',//跳转页
                    pageSize:'5', //一页的容量
                    loadingFlag:false,//等待条显示或隐藏标识
                    current_dependProv:'100000',//当前省份的pid
                    current_dependCity:'',//当前城市的pid
                    current_dependXian:'',//当前区县的pid
                    area_province:[],//省
					area_city:[],//市
					area_xian:[],//县
					last10Years:[],
					addr_provName:'',//省名称
					addr_cityName:'',//市名称
					addr_xianName:'',//区县名称
                    
                    query_customerID:'',
                    
                    edit_address:'',
                    edit_appCountry:'',
                    edit_appID:'',
                    edit_appIDCode:'',
                    edit_appName:'',
                    edit_appType:'',
                    edit_cityAddr:'',
                    edit_customerID:'',
                    edit_isRecord:'',
                    edit_recordValidYear:'',
                    edit_zipCode:'',
					
					custID:''
					
                },
                computed:{ 
				     show:function(){ 
				         return this.totalPage && this.totalPage !=1 
				     }, 
				     efont: function() { 
				       if (this.totalPage <= 7) return false; 
				       return this.currentPage > 5 
				     }, 
				     indexs: function() { 
				 
				       var left = 1, 
				         right = this.totalPage, 
				         ar = []; 
				       if (this.totalPage >= 7) { 
				         if (this.currentPage > 5 && this.currentPage < this.totalPage - 4) { 
				           left = Number(this.currentPage) - 3; 
				           right = Number(this.currentPage) + 3; 
				         } else { 
				           if (this.currentPage <= 5) { 
				             left = 1; 
				             right = 7; 
				           } else { 
				             right = this.totalPage; 
				 
				             left = this.totalPage - 6; 
				           } 
				         } 
				       } 
				       while (left <= right) { 
				         ar.push(left); 
				         left++; 
				       } 
				       return ar; 
				     }, 
			    }, 
                created:function(){
                 	var currentYear = new Date().getFullYear();//当前年份
// 	                alert(currentYear);
	                for(var i = 0;i<11;i++){
	                	this.last10Years[i]=currentYear++;
	                }
// 	                alert(this.last10Years);
                },
                ready:function(){
	                this.custID = custID;
	                this.loadSimpleCust();
// 	                this.loadData();
	            },
                methods:{
                	//加载页面主题内容
                    loadData:function(){
                   		
                    	this.loadingFlag = true;
                    	this.myData = [];//清空
                        this.$http.post('/listCustApplicationman',{
                            currentPage: this.currentPage,
                            pageSize:this.pageSize,
                            customerID: this.custID,
//                             customerID: this.query_customerID,
							nullParam:''//没用的参数，用来生成&。
                        },{
                            emulateJSON:true
                        }).then(function(res){//success
							this.loadingFlag = false;
							this.totalNum = res.data.custApplicationmanNum;
							this.totalPage = parseInt(((this.totalNum-1)/this.pageSize)+1);
							//alert(res.data.listCustApplicationman.length);
							for(var i = 0;i<res.data.listCustApplicationman.length;i++){
// 						    	alert(JSON.stringify(res.data.listUser[i]));//jquery解析json格式数据为string
							    this.myData.push(res.data.listCustApplicationman[i]); 
							}
                        },function(res){
                            //alert("error : "+res.status);//error
                        });
                    },
                    
                    //加载所有customer的方法
                    loadSimpleCust:function(){
//                     		alert(1);
	                		this.$http.post('/listSimpleCustomer',{
	                			nullParam1:'',//没用的参数，用来生成&。
	                            nullParam2:''//没用的参数，用来生成&。
	                        },{
	                            emulateJSON:true
	                        }).then(function(res){//success
		                        this.simpleCust = [];//清空
								let options = "";
								for(var i = 0;i<res.data.length;i++){
									this.simpleCust.push(res.data[i]);
									options += "<option value='" + res.data[i].customerID + "'>" + res.data[i].customerName + "</option>";
								}
								//alert(JSON.stringify(this.simpleCust.length));
								if(this.custID=='undefined'){
									this.custID=this.simpleCust[0].customerID;
								}
								
								this.loadData();
								
// 								  $("#id_combobox").empty();
							      $('#id_combobox').append(options);
// 							      $('#id_combobox').selectpicker('render');
							      $('#id_combobox').selectpicker('refresh');
// 							      $('#id_combobox').selectpicker();

// 								$("#id_combobox").find("option[value="+this.custID+"]").attr("selected",true);//普通select的默认选中方法
								$('#id_combobox').selectpicker('val',(this.custID));//bootstrap selectpicker   默认选中方法
								
								
	                        },function(res){
	                            //alert("error : "+res.status);//error
	                        });
	                },
	                
                    //页面跳转
                    jumpPage: function(id) {
					      var reg = /^[1-9]\d*$/
					      if(id==''||!reg.test(id)||id>this.totalPage){//校验跳转页是否合法
					      	alert('请填写一个不大于 '+this.totalPage+' 的整数');
					      	return;
					      }
// 					      alert(id);//加载数据操作
					      this.currentPage = id;
					      this.loadData();
					},
					//双击一行弹出编辑窗口
				    dblclickAline(id,index){
// 				    	alert(id+":"+index);
				    	$('#applicationman_myModal').modal('toggle');
				    	$("#applicationman_myModalLabel").text("编辑客户主体信息【申请人】");
				    	
				    	//设置待编辑的各项的值
						this.edit_address=this.myData[index].address;
						this.edit_appCountry=this.myData[index].appCountry;
						this.edit_appID=this.myData[index].appID;
						this.edit_appIDCode=this.myData[index].appIDCode;
						this.edit_appName=this.myData[index].appName;
						this.edit_appType=this.myData[index].appType;
						this.edit_cityAddr=this.myData[index].cityAddr;
						this.edit_customerID=this.myData[index].customerID;
						this.edit_isRecord=this.myData[index].isRecord;
						this.edit_recordValidYear=this.myData[index].recordValidYear;
						this.edit_zipCode=this.myData[index].zipCode;
						
						this.area_province=[];
// 						this.areaFunc(1);//获得省份
						$("#applicationman_myModal").css("height","700px");//设置弹出框的高度
// 						$(".modal-dialog").css("width","680px");//设置弹出框的宽度
				    },
				    
				    //点击新增按钮弹出新增窗口
				    addFunc(){
				    	$('#applicationman_myModal').modal('toggle');
						
						this.edit_address='';
						this.edit_appCountry='中国';
						this.edit_appID=guid();
						this.edit_appIDCode='';
						this.edit_appName='';
						this.edit_appType='企业';
						this.edit_cityAddr='';
						this.edit_customerID=this.custID;
						this.edit_isRecord='';
						this.edit_recordValidYear='-1';
						this.edit_zipCode='';
						
						this.areaFunc(1);//获得省份
						
						$("#applicationman_myModal").css("height","700px");//设置弹出框的高度
// 						$(".modal-dialog").css("width","680px");//设置弹出框的宽度
				    	$("#applicationman_myModalLabel").text("新增客户主体信息【申请人】");
				    },
				    
				    areaFunc:function(cenci){
				    	
// 						alert(cenci+":"+index);
						var tempD = '';
						if(cenci == 1){
							tempD = this.current_dependProv;
						}
						if(cenci == 2){
							tempD = this.current_dependCity;
							this.addr_provName = jQuery("#selectProv  option:selected").text();
							this.addr_cityName='';
							this.addr_xianName='';
						}
						if(cenci == 3){
							tempD = this.current_dependXian;
							this.addr_cityName = jQuery("#selectCity  option:selected").text();
							this.addr_xianName='';
						}
						if(cenci == 4){
							this.addr_xianName = jQuery("#selectXian  option:selected").text();
							return;
						}
						
						//this.edit_cityAddr=this.addr_provName+this.addr_cityName+this.addr_xianName;
                        this.$http.post('/listCityCode',{
                            pid: tempD,
                            nullParam:''//没用的参数，用来生成&。
                        },{
                            emulateJSON:true
                        }).then(function(res){//success
                        
                       			if(cenci == 1){
									this.area_province = [];//清空
								}
								if(cenci == 2){
									this.area_city = [];//清空
								}
								if(cenci == 3){
									this.area_xian = [];//清空
								}
	                        
//                             alert(res.data.length);
							for(var i = 0;i<res.data.length;i++){
// 						    	alert(JSON.stringify(res.data[i]));//jquery解析json格式数据为string
								if(cenci == 1){
									this.area_province.push(res.data[i]);
								}
								if(cenci == 2){
									this.area_city.push(res.data[i]);
								}
								if(cenci == 3){
									this.area_xian.push(res.data[i]);
								}
								
							}
// 							alert(JSON.stringify(this.area_province));
                        },function(res){
                            //alert("error : "+res.status);//error
                        });
                    },
				    
				    //提交数据
				    submitFunc:function(){
				    	
				    	
				        if($("#applicationman_myModalLabel").text().indexOf("编辑") != -1){
							this.loadingFlag = true;
	                        this.$http.post('/updateCustApplicationman',{
								
								address: this.edit_address,
								appCountry: this.edit_appCountry,
								appID: this.edit_appID,
								appIDCode: this.edit_appIDCode,
								appName: this.edit_appName,
								appType: this.edit_appType,
								cityAddr: this.edit_cityAddr,
								customerID: this.edit_customerID,
								isRecord: this.edit_isRecord==true?1:0,
								recordValidYear: this.edit_recordValidYear,
								zipCode: this.edit_zipCode
								
	                        },{
	                            emulateJSON:true
	                        }).then(function(res){//success
								this.loadingFlag = false;
// 								alert(res.data.msg);
								this.loadData();
	                        },function(res){
	                            alert(res.data.msg+" : "+res.status);//error
	                        });
				        }
				        
				    	if($("#applicationman_myModalLabel").text().indexOf("新") != -1){
				    		
					    	this.loadingFlag = true;
	                        this.$http.post('/addCustApplicationman',{
								address: this.edit_address,
								appCountry: this.edit_appCountry,
								appID: this.edit_appID,
								appIDCode: this.edit_appIDCode,
								appName: this.edit_appName,
								appType: this.edit_appType,
// 								cityAddr: this.edit_cityAddr,
								cityAddr: this.addr_provName+this.addr_cityName+this.addr_xianName,
								customerID: this.edit_customerID,
								isRecord: this.edit_isRecord==true?1:0,
								recordValidYear: this.edit_recordValidYear,
								zipCode: this.edit_zipCode
								
	                        },{
	                            emulateJSON:true
	                        }).then(function(res){//success
								this.loadingFlag = false;
// 								alert(res.data.msg);
								this.loadData();
	                        },function(res){
	                            alert(res.data.msg+" : "+res.status);//error
	                        });
				    	}
				    	
	                    $('#applicationman_myModal').modal('toggle');
				    }
				    
                }
            });
            var v_link = new Vue({
                el:'#box_link',
                data:{
					myData:[], // 列表数据
                    totalNum:'',//总条数 
                    totalPage:'',//总页数 
                    currentPage:1,//当前页 
                    changePage:'',//跳转页
                    pageSize:'5', //一页的容量
                    loadingFlag:false,//等待条显示或隐藏标识
                    
                    query_linkName:'',
                    
                    edit_customerID:'',
                    edit_linkCellPhone:'',
                    edit_linkEmail:'',
                    edit_linkID:'',
                    edit_linkName:'',
                    edit_linkQQ:'',
                    edit_linkTel:'',
                    edit_linkWeChat:'',
                    edit_nickName:''
					
                },
                computed:{ 
				     show:function(){ 
				         return this.totalPage && this.totalPage !=1 
				     }, 
				     efont: function() { 
				       if (this.totalPage <= 7) return false; 
				       return this.currentPage > 5 
				     }, 
				     indexs: function() { 
				 
				       var left = 1, 
				         right = this.totalPage, 
				         ar = []; 
				       if (this.totalPage >= 7) { 
				         if (this.currentPage > 5 && this.currentPage < this.totalPage - 4) { 
				           left = Number(this.currentPage) - 3; 
				           right = Number(this.currentPage) + 3; 
				         } else { 
				           if (this.currentPage <= 5) { 
				             left = 1; 
				             right = 7; 
				           } else { 
				             right = this.totalPage; 
				 
				             left = this.totalPage - 6; 
				           } 
				         } 
				       } 
				       while (left <= right) { 
				         ar.push(left); 
				         left++; 
				       } 
				       return ar; 
				     }, 
			    }, 
                created:function(){

                },
                ready:function(){
	                this.loadData();
	            },
                methods:{
                	//加载页面主题内容
                    loadData:function(){
                   		
                   		
                    	this.loadingFlag = true;
                    	this.myData = [];//清空
                        this.$http.post('/listCustLinkman',{
                            currentPage: this.currentPage,
                            pageSize:this.pageSize,
//                             customerID: v_app.query_customerID,
							customerID: v_app.custID,
                            linkName: this.query_linkName,
							nullParam:''//没用的参数，用来生成&。
                        },{
                            emulateJSON:true
                        }).then(function(res){//success
                        
							this.loadingFlag = false;
							this.totalNum = res.data.custLinkmanNum;
							this.totalPage = parseInt(((this.totalNum-1)/this.pageSize)+1);
							//alert(res.data.listCustLinkman.length);
							for(var i = 0;i<res.data.listCustLinkman.length;i++){
// 						    	alert(JSON.stringify(res.data.listUser[i]));//jquery解析json格式数据为string
							    this.myData.push(res.data.listCustLinkman[i]); 
							}
                        },function(res){
                            //alert("error : "+res.status);//error
                        });
                    },
                    
                    //页面跳转
                    jumpPage: function(id) {
					      var reg = /^[1-9]\d*$/
					      if(id==''||!reg.test(id)||id>this.totalPage){//校验跳转页是否合法
					      	alert('请填写一个不大于 '+this.totalPage+' 的整数');
					      	return;
					      }
// 					      alert(id);//加载数据操作
					      this.currentPage = id;
					      this.loadData();
					},
					//双击一行弹出编辑窗口
				    dblclickAline(id,index){
// 				    	alert(id+":"+index);
				    	$('#linkman_myModal').modal('toggle');
				    	$("#linkman_myModalLabel").text("编辑客户主体信息【联系人】");
				    	
				    	//设置待编辑的各项的值
						this.edit_customerID=this.myData[index].customerID;
						this.edit_linkCellPhone=this.myData[index].linkCellPhone;
						this.edit_linkEmail=this.myData[index].linkEmail;
						this.edit_linkID=this.myData[index].linkID;
						this.edit_linkName=this.myData[index].linkName;
						this.edit_linkQQ=this.myData[index].linkQQ;
						this.edit_linkTel=this.myData[index].linkTel;
						this.edit_linkWeChat=this.myData[index].linkWeChat;
						this.edit_nickName=this.myData[index].nickName;
					
						$("#linkman_myModal").css("height","700px");//设置弹出框的高度
// 						$(".modal-dialog").css("width","680px");//设置弹出框的宽度
				    },
				    
				    //点击新增按钮弹出新增窗口
				    addFunc(){
// 				    	alert(v_app.currentPage);
// 				    	alert(v_app.custID);
				    	$('#linkman_myModal').modal('toggle');
						
// 						this.edit_customerID=v_app.custID;//
						this.edit_customerID='46a86acd-b9e0-f9b5-a3e9-5c86fb81ef27';//
						this.edit_linkCellPhone='';
						this.edit_linkEmail='';
						this.edit_linkID=guid();
						this.edit_linkName='';
						this.edit_linkQQ='';
						this.edit_linkTel='';
						this.edit_linkWeChat='';
						this.edit_nickName='';
						
						$("#linkman_myModal").css("height","700px");//设置弹出框的高度
// 						$(".modal-dialog").css("width","680px");//设置弹出框的宽度
				    	$("#linkman_myModalLabel").text("新增客户主体信息【联系人】");
				    },
				    
				    //提交数据
				    submitFunc:function(){
				    	
				        if($("#linkman_myModalLabel").text().indexOf("编辑") != -1){
							this.loadingFlag = true;
	                        this.$http.post('/updateCustLinkman',{
								
								customerID: this.edit_customerID,
								linkCellPhone: this.edit_linkCellPhone,
								linkEmail: this.edit_linkEmail,
								linkID: this.edit_linkID,
								linkName: this.edit_linkName,
								linkQQ: this.edit_linkQQ,
								linkTel: this.edit_linkTel,
								linkWeChat: this.edit_linkWeChat,
								nickName: this.edit_nickName
								
	                        },{
	                            emulateJSON:true
	                        }).then(function(res){//success
								this.loadingFlag = false;
// 								alert(res.data.msg);
								this.loadData();
	                        },function(res){
	                            alert(res.data.msg+" : "+res.status);//error
	                        });
				        }
				        
				    	if($("#linkman_myModalLabel").text().indexOf("新") != -1){
				    		
					    	this.loadingFlag = true;
	                        this.$http.post('/addCustLinkman',{
								customerID: this.edit_customerID,
								linkCellPhone: this.edit_linkCellPhone,
								linkEmail: this.edit_linkEmail,
								linkID: this.edit_linkID,
								linkName: this.edit_linkName,
								linkQQ: this.edit_linkQQ,
								linkTel: this.edit_linkTel,
								linkWeChat: this.edit_linkWeChat,
								nickName: this.edit_nickName
								
	                        },{
	                            emulateJSON:true
	                        }).then(function(res){//success
								this.loadingFlag = false;
// 								alert(res.data.msg);
								this.loadData();
	                        },function(res){
	                            alert(res.data.msg+" : "+res.status);//error
	                        });
				    	}
				    	
	                    $('#linkman_myModal').modal('toggle');
				    }
                }
            }); 
            var v_invent = new Vue({
                el:'#box_invent',
                data:{
                	myData:[], // 列表数据
                    totalNum:'',//总条数 
                    totalPage:'',//总页数 
                    currentPage:1,//当前页 
                    changePage:'',//跳转页
                    pageSize:'5', //一页的容量
                    loadingFlag:false,//等待条显示或隐藏标识
                    
                    query_inventName:'',
                    
                    edit_customerID:'',
                    edit_inventCountry:'',
                    edit_inventID:'',
                    edit_inventIDCode:'',
                    edit_inventName:''
                },
                computed:{ 
				     show:function(){ 
				         return this.totalPage && this.totalPage !=1 
				     }, 
				     efont: function() { 
				       if (this.totalPage <= 7) return false; 
				       return this.currentPage > 5 
				     }, 
				     indexs: function() { 
				 
				       var left = 1, 
				         right = this.totalPage, 
				         ar = []; 
				       if (this.totalPage >= 7) { 
				         if (this.currentPage > 5 && this.currentPage < this.totalPage - 4) { 
				           left = Number(this.currentPage) - 3; 
				           right = Number(this.currentPage) + 3; 
				         } else { 
				           if (this.currentPage <= 5) { 
				             left = 1; 
				             right = 7; 
				           } else { 
				             right = this.totalPage; 
				 
				             left = this.totalPage - 6; 
				           } 
				         } 
				       } 
				       while (left <= right) { 
				         ar.push(left); 
				         left++; 
				       } 
				       return ar; 
				     }, 
			    }, 
                created:function(){
                },
                ready:function(){
	                this.loadData();
	            },
                methods:{
                	//加载页面主题内容
                    loadData:function(){
                   
                    	this.loadingFlag = true;
                    	this.myData = [];//清空
                        this.$http.post('/listCustInventman',{
                            currentPage: this.currentPage,
                            pageSize:this.pageSize,
//                             customerID: v_app.query_customerID,
                            customerID: v_app.custID,
                            inventName: this.query_inventName,
							nullParam:''//没用的参数，用来生成&。
                        },{
                            emulateJSON:true
                        }).then(function(res){//success
							this.loadingFlag = false;
							this.totalNum = res.data.custInventmanNum;
							this.totalPage = parseInt(((this.totalNum-1)/this.pageSize)+1);
							//alert(res.data.listCustInventman.length);
							for(var i = 0;i<res.data.listCustInventman.length;i++){
// 						    	alert(JSON.stringify(res.data.listUser[i]));//jquery解析json格式数据为string
							    this.myData.push(res.data.listCustInventman[i]); 
							}
                        },function(res){
                            //alert("error : "+res.status);//error
                        });
                    },
                    
                    //页面跳转
                    jumpPage: function(id) {
					      var reg = /^[1-9]\d*$/
					      if(id==''||!reg.test(id)||id>this.totalPage){//校验跳转页是否合法
					      	alert('请填写一个不大于 '+this.totalPage+' 的整数');
					      	return;
					      }
// 					      alert(id);//加载数据操作
					      this.currentPage = id;
					      this.loadData();
					},
					//双击一行弹出编辑窗口
				    dblclickAline(id,index){
// 				    	alert(id+":"+index);
				    	$('#inventman_myModal').modal('toggle');
				    	$("#inventman_myModalLabel").text("编辑客户主体信息【发明人】");
				    	
				    	//设置待编辑的各项的值
						this.edit_customerID=this.myData[index].customerID;
						this.edit_inventCountry=this.myData[index].inventCountry;
						this.edit_inventID=this.myData[index].inventID;
						this.edit_inventIDCode=this.myData[index].inventIDCode;
						this.edit_inventName=this.myData[index].inventName;
						
						$("#inventman_myModal").css("height","700px");//设置弹出框的高度
// 						$(".modal-dialog").css("width","680px");//设置弹出框的宽度
				    },
				    
				    //点击新增按钮弹出新增窗口
				    addFunc(){
				    	$('#inventman_myModal').modal('toggle');
						
						this.edit_customerID=v_app.custID;
						this.edit_inventCountry='中国';
						this.edit_inventIDCode='';
						this.edit_inventName='';
						this.edit_inventID=guid();
						
						
						$("#inventman_myModal").css("height","700px");//设置弹出框的高度
// 						$(".modal-dialog").css("width","680px");//设置弹出框的宽度
				    	$("#inventman_myModalLabel").text("新增客户主体信息【发明人】");
				    },
				    
				    //提交数据
				    submitFunc:function(){
				    	
				    	
				        if($("#inventman_myModalLabel").text().indexOf("编辑") != -1){
							this.loadingFlag = true;
	                        this.$http.post('/updateCustInventman',{
								
								inventIDCode: this.edit_inventIDCode,
								inventCountry: this.edit_inventCountry,
								customerID: this.edit_customerID,
								inventID: this.edit_inventID,
								inventName: this.edit_inventName
								
	                        },{
	                            emulateJSON:true
	                        }).then(function(res){//success
								this.loadingFlag = false;
// 								alert(res.data.msg);
								this.loadData();
	                        },function(res){
	                            alert(res.data.msg+" : "+res.status);//error
	                        });
				        }
				        
				    	if($("#inventman_myModalLabel").text().indexOf("新") != -1){
				    		
					    	this.loadingFlag = true;
	                        this.$http.post('/addCustInventman',{
								inventIDCode: this.edit_inventIDCode,
								inventCountry: this.edit_inventCountry,
								customerID: this.edit_customerID,
								inventID: this.edit_inventID,
								inventName: this.edit_inventName
								
	                        },{
	                            emulateJSON:true
	                        }).then(function(res){//success
								this.loadingFlag = false;
// 								alert(res.data.msg);
								this.loadData();
	                        },function(res){
	                            alert(res.data.msg+" : "+res.status);//error
	                        });
				    	}
				    	
	                    $('#inventman_myModal').modal('toggle');
				    }
                }
            });
            
            
            
            
            //

            
        });
        
    </script>	
</head>

<body>
	<div class="container" id="boxContainer">

		 
		 <div class="header">
		   <ul class="nav nav-pills pull-right">
		     <li class="active"><a href="/"><span class="glyphicon glyphicon-home"></span> Home</a></li>
		     <li><a href="#">关于</a></li>
		     <li><a href="/gotoLogoutPage">安全退出</a></li> 
		   </ul>
		   <h3 class="text-muted ">客户主体信息管理 <span class="glyphicon glyphicon-hand-right"></span> </h3>
		 </div>
		 
		<ul class="nav nav-tabs">
			<li class="active"><a href="#box_app" data-toggle="tab" @click="changeTab(1)">申请人</a></li>
			<li><a href="#box_invent" data-toggle="tab" @click="changeTab(2)">发明人</a></li>
			<li><a href="#box_link" data-toggle="tab" @click="changeTab(3)">联系人</a></li>
		</ul>
		 
     </div>
     
    <div class="tab-content"> 
		<div class="container tab-pane fade" id="box_invent">
<!-- 			<div id="loading" class="loading" v-show=loadingFlag>加载中...</div> -->
			发明人tab
			<form class="form-inline form-group-sm" role="form">
				
				 <div class="form-group">
	                <label for="id_query_inventName">发明人名称:</label>
	                <input type="text" id="id_query_inventName" class="form-control" placeholder="输入发明人名称" v-model="query_inventName" maxlength="30">
	             </div>
	             <div class="form-group">
			    	<button type="button" class="btn btn-info"  @click="currentPage=1,loadData()" >查询</button>
	<!-- 		    注意 ： 此处用submit会重复提交，导致数据错误
			    	<button type="submit" class="btn btn-info"  @click="currentPage=1,loadData()">查询</button>
	-->
			    </div>
			            
			</form>
			
			 <table class="table table-bordered table-hover text-nowrap">
	            <div class="pull-right">
	            	<strong  class="lead text-primary tishi">双击各行可编辑</strong>
					<button class="btn btn-primary btn-lg" data-toggle="modal" @click="addFunc()">
						新增客户主体信息
					</button>
	            </div>
	<!--             <colgroup> -->
	<!-- 	            <col> -->
	<!-- 	            <col> -->
	<!-- 	            <col style="width: 60%"> -->
	<!--             </colgroup> -->
		            <tr class="text-danger warning">
		                <th class="text-center">序号</th>
		                <th class="text-center">国别</th>
		                <th class="text-center">姓名</th>
		                <th class="text-center">证件号</th>
		            </tr>
		            <tr class="text-center" v-for="item in myData"  @dblclick="dblclickAline(item.inventID,$index)">
		                <td>{{$index+1}}</td>
		                <td>{{item.inventCountry}}</td>
		                <td>{{item.inventName}}</td>
		                <td>{{item.inventIDCode}}</td>
		            </tr>
		            
		            <tr v-show="myData.length==0" >
		                <td colspan="4">
		                    <p>暂无数据....</p>
		                </td>
		            </tr>
	        </table>
	        
			<div> 
			    <div class="page"  v-show="show"> 
			      <div class="pagelist"> 
			        <span class="jump" v-show="currentPage>1" @click="currentPage--,jumpPage(currentPage)">上一页</span> 
			        <span v-show="currentPage>5" class="jump" @click="jumpPage(1)">1</span> 
			        <span class="ellipsis"  v-show="efont">...</span> 
			        <span class="jump" v-for="num in indexs" :class="{bgprimary:currentPage==num}" @click="jumpPage(num)">{{num}}</span> 
			        <span class="ellipsis"  v-show="efont&&currentPage<totalPage-4">...</span> 
			 
			        <span class="jump" v-show="currentPage<totalPage" @click="currentPage++,jumpPage(currentPage)">下一页</span> 
			        <span v-show="currentPage<totalPage-1" class="jump" class="jump" @click="jumpPage(totalPage)">末页{{totalPage}}</span> 
			 
			        <span class="jumppoint">
			        <a class="" style="text-decoration:none; cursor:hand "
							 data-toggle="popover" data-placement="top" 
							data-content="点击GO按钮可以直接跳到指定的页面">
						跳转到：
					</a></span> 
			        <span class="jumpinp"><input type="text" v-model="changePage"></span> 
			        <span class="jump gobtn" @click="jumpPage(changePage)">GO</span> 
			        <span class="jumpinp"> 第{{currentPage}}页     共{{totalPage}}页 </span> 
			      </div> 
			    </div> 
			  </div>
						  
			<!-- 模态框（Modal） -->
			<div class="modal fade modalWindow" id="inventman_myModal" tabindex="-1" role="dialog" aria-labelledby="inventman_myModalLabel" aria-hidden="true" data-backdrop="false">
				<div class="modal-dialog" >
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
								&times;
							</button>
							<h4 class="modal-title" id="inventman_myModalLabel">
								***
							</h4>
						</div>
						<div class="modal-body">
						
							<div class="form-group ">
						        <label>国别:</label>
								<select class="selectpicker form-control" data-style="btn-info"  title="国别" v-model="edit_inventCountry">
									<option value="中国" selected="selected">中国</option>
									<option value="美国">美国</option>
									<option value="日本">日本</option>
								 </select>
						    </div>
							
				            <div class="form-group">
				                <label for="id_edit_inventName">姓名</label>
				                <input type="text" id="id_edit_inventName" class="form-control" placeholder="输入姓名" v-model="edit_inventName" maxlength="30">
				            </div>
				            <div class="form-group">
				                <label for="id_edit_inventIDCode">证件号码:</label>
				                <input type="text" id="id_edit_inventIDCode" class="form-control" placeholder="输入证件号码" v-model="edit_inventIDCode" maxlength="20">
				            </div>
				            
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
							<button type="button" class="btn btn-primary" @click="submitFunc()">提交</button>
						</div>
					</div><!-- /.modal-content -->
				</div><!-- /.modal -->
			</div>
		</div><!-- box_invent end  -->
		<div class=" container tab-pane fade" id="box_link">
<!-- 			<div id="loading" class="loading" v-show=loadingFlag>加载中...</div> -->
			联系人tab
			<form class="form-inline form-group-sm" role="form">
				
				 <div class="form-group">
	                <label for="id_query_linkName">联系人名称:</label>
	                <input type="text" id="id_query_linkName" class="form-control" placeholder="输入联系人名称" v-model="query_linkName" maxlength="30">
	             </div>
	             <div class="form-group">
			    	<button type="button" class="btn btn-info"  @click="currentPage=1,loadData()" >查询</button>
	<!-- 		    注意 ： 此处用submit会重复提交，导致数据错误
			    	<button type="submit" class="btn btn-info"  @click="currentPage=1,loadData()">查询</button>
	-->
			    </div>
			            
			</form>
			
			 <table class="table table-bordered table-hover text-nowrap">
	            <div class="pull-right">
	            	<strong  class="lead text-primary tishi">双击各行可编辑</strong>
					<button class="btn btn-primary btn-lg" data-toggle="modal" @click="addFunc()">
						新增客户主体信息
					</button>
	            </div>
	<!--             <colgroup> -->
	<!-- 	            <col> -->
	<!-- 	            <col> -->
	<!-- 	            <col style="width: 60%"> -->
	<!--             </colgroup> -->
		            <tr class="text-danger warning">
		                <th class="text-center">序号</th>
		                <th class="text-center">姓名</th>
		                <th class="text-center">称谓</th>
		                <th class="text-center">电话 </th>
		                <th class="text-center">邮箱</th>
		                <th class="text-center">微信</th>
		                <th class="text-center">QQ</th>
		                <th class="text-center">座机</th>
		            </tr>
		            <tr class="text-center" v-for="item in myData"  @dblclick="dblclickAline(item.linkID,$index)">
		                <td>{{$index+1}}</td>
		                <td>{{item.linkName}}</td>
		                <td>{{item.nickName}}</td>
		                <td>{{item.linkCellPhone}}</td>
		                <td>{{item.Email}}</td>
		                <td>{{item.linkWeChat}}</td>
		                <td>{{item.linkQQ}}</td>
		                <td>{{item.linkTel}}</td>
		                
		            </tr>
		            <tr v-show="myData.length==0" >
		                <td colspan="8">
		                    <p>暂无数据....</p>
		                </td>
		            </tr>
	        </table>
	        
			<div> 
			    <div class="page"  v-show="show"> 
			      <div class="pagelist"> 
			        <span class="jump" v-show="currentPage>1" @click="currentPage--,jumpPage(currentPage)">上一页</span> 
			        <span v-show="currentPage>5" class="jump" @click="jumpPage(1)">1</span> 
			        <span class="ellipsis"  v-show="efont">...</span> 
			        <span class="jump" v-for="num in indexs" :class="{bgprimary:currentPage==num}" @click="jumpPage(num)">{{num}}</span> 
			        <span class="ellipsis"  v-show="efont&&currentPage<totalPage-4">...</span> 
			 
			        <span class="jump" v-show="currentPage<totalPage" @click="currentPage++,jumpPage(currentPage)">下一页</span> 
			        <span v-show="currentPage<totalPage-1" class="jump" class="jump" @click="jumpPage(totalPage)">末页{{totalPage}}</span> 
			 
			        <span class="jumppoint">
			        <a class="" style="text-decoration:none; cursor:hand "
							 data-toggle="popover" data-placement="top" 
							data-content="点击GO按钮可以直接跳到指定的页面">
						跳转到：
					</a></span> 
			        <span class="jumpinp"><input type="text" v-model="changePage"></span> 
			        <span class="jump gobtn" @click="jumpPage(changePage)">GO</span> 
			        <span class="jumpinp"> 第{{currentPage}}页     共{{totalPage}}页 </span> 
			      </div> 
			    </div> 
			  </div>
			
			<!-- 模态框（Modal） -->
			<div class="modal fade modalWindow" id="linkman_myModal" tabindex="-1" role="dialog" aria-labelledby="linkman_myModalLabel" aria-hidden="true" data-backdrop="false">
				<div class="modal-dialog" >
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
								&times;
							</button>
							<h4 class="modal-title" id="linkman_myModalLabel">
								***
							</h4>
						</div>
						<div class="modal-body">
						
				            <div class="form-group">
				                <label for="id_edit_linkName">姓名</label>
				                <input type="text" id="id_edit_linkName" class="form-control" placeholder="输入姓名" v-model="edit_linkName" maxlength="30">
				            </div>
				            <div class="form-group">
				                <label for="id_edit_nickName">称谓</label>
				                <input type="text" id="id_edit_nickName" class="form-control" placeholder="输入称谓" v-model="edit_nickName" maxlength="20">
				            </div>
				            <div class="form-group">
				                <label for="id_edit_linkCellPhone">手机</label>
				                <input type="text" id="id_edit_linkCellPhone" class="form-control" placeholder="输入手机" v-model="edit_linkCellPhone" maxlength="11">
				            </div>
				            <div class="form-group">
				                <label for="id_edit_linkEmail">邮箱</label>
				                <input type="text" id="id_edit_linkEmail" class="form-control" placeholder="输入邮箱" v-model="edit_linkEmail" maxlength="30">
				            </div>
				            <div class="form-group">
				                <label for="id_edit_linkWeChat">微信</label>
				                <input type="text" id="id_edit_linkWeChat" class="form-control" placeholder="输入微信" v-model="edit_linkWeChat" maxlength="15">
				            </div>
				            <div class="form-group">
				                <label for="id_edit_linkQQ">QQ</label>
				                <input type="text" id="id_edit_linkQQ" class="form-control" placeholder="输入QQ" v-model="edit_linkQQ" maxlength="15">
				            </div>
				            <div class="form-group">
				                <label for="id_edit_linkTel">座机</label>
				                <input type="text" id="id_edit_linkTel" class="form-control" placeholder="输入座机" v-model="edit_linkTel" maxlength="20">
				            </div>
				            
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
							<button type="button" class="btn btn-primary" @click="submitFunc()">提交</button>
						</div>
					</div><!-- /.modal-content -->
				</div><!-- /.modal -->
			</div>
		</div><!-- box_link end  -->

		<div class="active container tab-pane" id="box_app">
			申请人tab{{custID}}|||{{v_app.custID}}
			<div id="loading" class="loading" v-show=loadingFlag>加载中...</div>
			 <form class="form-inline form-group-sm" role="form">
				 <label >客户姓名:</label>
			 	 <div class="form-group">
				      <select id="id_combobox" v-model="custID" class="selectpicker show-tick form-control" data-live-search="true" @change="currentPage=1,loadData()">
					    <!-- <option v-for="item in simpleCust" value="{{item.customerID}}">{{item.customerName}}</option> -->
					  </select>
				</div>
			</form>
			
			 <table class="table table-bordered table-hover text-nowrap">
	            <div class="pull-right">
	            	<strong  class="lead text-primary tishi">双击各行可编辑</strong>
					<button class="btn btn-primary btn-lg" data-toggle="modal" @click="addFunc()">
						新增客户主体信息
					</button>
	            </div>
	<!--             <colgroup> -->
	<!-- 	            <col> -->
	<!-- 	            <col> -->
	<!-- 	            <col style="width: 60%"> -->
	<!--             </colgroup> -->
		            <tr class="text-danger warning">
		                <th class="text-center">序号</th>
		                <th class="text-center">国别</th>
		                <th class="text-center">姓名/名称</th>
		                <th class="text-center">证件号</th>
		                <th class="text-center">是否备案</th>
		                <th class="text-center">备案有效期</th>
		                <th class="text-center">地区</th>
		                <th class="text-center">地址</th>
		                <th class="text-center">邮编</th>
		            </tr>
		            <tr class="text-center" v-for="item in myData"  @dblclick="dblclickAline(item.appID,$index)">
		                <td>{{$index+1}}</td>
		                <td>{{item.appCountry}}</td>
		                <td>{{item.appName}}</td>
		                <td>{{item.appIDCode}}</td>
		                <td>{{item.isRecord}}</td>
		                <td>{{item.recordValidYear}}</td>
		                <td>{{item.cityAddr}}</td>
		                <td title="{{item.address}}">{{item.address.substring(0, 15)+ "..."}}</td>
		                <td>{{item.zipCode}}</td>
		            </tr>
		            <tr v-show="myData.length==0" >
		                <td colspan="9">
		                    <p>暂无数据....</p>
		                </td>
		            </tr>
	        </table>
	        
			<div> 
			    <div class="page"  v-show="show"> 
			      <div class="pagelist"> 
			        <span class="jump" v-show="currentPage>1" @click="currentPage--,jumpPage(currentPage)">上一页</span> 
			        <span v-show="currentPage>5" class="jump" @click="jumpPage(1)">1</span> 
			        <span class="ellipsis"  v-show="efont">...</span> 
			        <span class="jump" v-for="num in indexs" :class="{bgprimary:currentPage==num}" @click="jumpPage(num)">{{num}}</span> 
			        <span class="ellipsis"  v-show="efont&&currentPage<totalPage-4">...</span> 
			 
			        <span class="jump" v-show="currentPage<totalPage" @click="currentPage++,jumpPage(currentPage)">下一页</span> 
			        <span v-show="currentPage<totalPage-1" class="jump" class="jump" @click="jumpPage(totalPage)">末页{{totalPage}}</span> 
			 
			        <span class="jumppoint">
			        <a class="" style="text-decoration:none; cursor:hand "
							 data-toggle="popover" data-placement="top" 
							data-content="点击GO按钮可以直接跳到指定的页面">
						跳转到：
					</a></span> 
			        <span class="jumpinp"><input type="text" v-model="changePage"></span> 
			        <span class="jump gobtn" @click="jumpPage(changePage)">GO</span> 
			        <span class="jumpinp"> 第{{currentPage}}页     共{{totalPage}}页 </span> 
			      </div> 
			    </div> 
			  </div>
						  
						  
			
			
			<!-- 模态框（Modal） -->
			<div class="modal fade modalWindow" id="applicationman_myModal" tabindex="-1" role="dialog" aria-labelledby="applicationman_myModalLabel" aria-hidden="true" data-backdrop="false">
				<div class="modal-dialog" >
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-hidden="true">
								&times;
							</button>
							<h4 class="modal-title" id="applicationman_myModalLabel">
								***
							</h4>
						</div>
						<div class="modal-body">
						
							<div class="form-group ">
						        <label>国别:</label>
								<select class="selectpicker form-control" data-style="btn-info"  title="国别" v-model="edit_appCountry">
									<option value="中国" selected="selected">中国</option>
									<option value="美国">美国</option>
									<option value="日本">日本</option>
								 </select>
						    </div>
							<div class="form-group ">
						        <label>类型:</label>
								<select class="selectpicker form-control" data-style="btn-info"  title="类型" v-model="edit_appType">
									<option selected="selected" value="企业" >企业</option>
									<option value="个人">个人</option>
									<option value="大专院校">大专院校</option>
									<option value="科研院所">科研院所</option>
									<option value="事业单位">事业单位</option>
								 </select>
						    </div>
							
				            <div class="form-group">
				                <label for="id_edit_appName">姓名/名称</label>
				                <input type="text" id="id_edit_appName" class="form-control" placeholder="输入姓名/名称" v-model="edit_appName" maxlength="30">
				            </div>
				            <div class="form-group">
				                <label for="id_edit_appIDCode">证件号码:</label>
				                <input type="text" id="id_edit_appIDCode" class="form-control" placeholder="输入证件号码" v-model="edit_appIDCode" maxlength="20">
				            </div>
				             <div class="checkbox">
							    <label>
							      <input type="checkbox" v-model="edit_isRecord"> 是否备案
							    </label>
							  </div>
				            
				            <div class="form-group ">
						        <label>备案有效期:</label>
								
								<select class="form-control" title="备案有效期" v-model="edit_recordValidYear">
									<option  value="-1">--请选择备案有效期--</option>
									<option v-for="item in last10Years" value="{{item}}">{{item}}</option>
								</select>
						    </div>
						    
						    
						    
						    <label>地区:</label>{{edit_cityAddr}}
							<div class="form-group"  v-show="area_province.length!=0">
						        <label>省份:</label>
								<select class="form-control" id="selectProv" @change="areaFunc(2)"  v-model="current_dependCity">
									<option value="100000" selected="selected">--请选择省份--</option>
									<option v-for="item in area_province" value="{{item.cityCode}}">{{item.cityName}}</option>
								 </select>
						    
							
						        <label>城市:</label>
								<select class="form-control" id="selectCity" @change="areaFunc(3)"  v-model="current_dependXian">
									<option value="-1" selected="selected">--请选择城市--</option>
	<!-- <option v-for="item in area_city" value="{{item.cityCode}}~{{$index}}">{{item.cityName}}</option> -->
									<option v-for="item in area_city" value="{{item.cityCode}}">{{item.cityName}}</option>
								 </select>
						    
						        <label>区县:</label>
								<select class="form-control" id="selectXian" @change="areaFunc(4)">
									<option value="-1" selected="selected" >--请选择区县--</option>
									<option v-for="item in area_xian" value="{{item.cityCode}}">{{item.cityName}}</option>
								 </select>
						    </div>
				            
						 	<div class="form-group">
				                <label for="id_edit_address">地址:</label>
				                <textarea id="id_edit_address" rows="3" class="form-control" placeholder="输入地址" v-model="edit_address" maxlength="100"></textarea>
				            </div>
						 	<div class="form-group">
				                <label for="id_edit_zipCode">邮编:</label>
				                <input type="text" id="id_edit_zipCode" class="form-control" placeholder="输入邮编" v-model="edit_zipCode" maxlength="20">
				            </div>
						 	
				            
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
							<button type="button" class="btn btn-primary" @click="submitFunc()">提交</button>
						</div>
					</div><!-- /.modal-content -->
				</div><!-- /.modal -->
			</div>
			
		</div><!-- box_app end -->
	</div>
	
	<div class="footer">
			<iframe src="../footer.html" width="100%" frameborder="0" scrolling="no"></iframe>
	</div>

</body>
</html>
